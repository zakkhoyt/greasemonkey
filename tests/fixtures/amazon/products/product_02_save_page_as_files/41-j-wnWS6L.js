'use strict';(function(k){var m=window.AmazonUIPageJS||window.P,r=m._namespace||m.attributeErrors,c=r?r("DetailPageUnifiedTradeInIngressAssets",""):m;c.guardFatal?c.guardFatal(k)(c,window):c.execute(function(){k(c,window)})})(function(k,m,r){k.when("A","cc-manager","unified-trade-in-cc-constants").register("unified-trade-in-add-to-cart-actions",(c,a,d)=>({addAdditionalParamToATC:function(c){c&&(c={selectionType:"add",enableIA:!1,formData:[{inputType:"hidden",inputName:"tradeInIntentId",inputValue:c}]},
a.ccSelectionsClear(d.featureName),a.ccSelectionUpdate(d.featureName,c))}}));"use strict";k.when("A","a-button","unified-trade-in-cc-constants","unified-trade-in-metric-emitter").register("unified-trade-in-button-factory",(c,a,d,f)=>{function n(a){return a.hasClass(d.uiElements.buttonFactory.actionButtonClass)&&0<a.find(d.uiElements.buttonFactory.displayTextSelector).length&&0<a.find(d.uiElements.buttonFactory.loadingSpinnerSelector).length}return{getInstance:function(h,k){if(!n(h)||!k)return f.count("UnifiedTradeIn.Error.ButtonFactory.GetInstance.InvalidButton"),
null;const p=d.uiElements.buttonFactory.classPrefix+k;h.addClass(p);const g=a("."+p);let t,e;return{isBlocked(){return!g.isEnabled()},block(){this.isBlocked()?f.count("UnifiedTradeIn.Error.ButtonController.Block.AlreadyBlocked"):(g.disable(),t=c.delay(()=>{h.find(d.uiElements.buttonFactory.displayTextSelector).addClass(d.uiElements.styles.invisibleClass);h.find(d.uiElements.buttonFactory.loadingSpinnerSelector).removeClass(d.uiElements.styles.invisibleClass)},d.uiElements.buttonFactory.spinnerDelayMs),
e=c.delay(()=>{this.reset()},d.remoteOperations.timeoutMs))},reset(){clearTimeout(t);clearTimeout(e);h.find(d.uiElements.buttonFactory.loadingSpinnerSelector).addClass(d.uiElements.styles.invisibleClass);h.find(d.uiElements.buttonFactory.displayTextSelector).removeClass(d.uiElements.styles.invisibleClass);g.enable()},destroy(){this.reset();h.removeClass(p)}}}}});"use strict";k.when("A","unified-trade-in-cc-constants","unified-trade-in-add-to-cart-actions","cc-manager","unified-trade-in-quantity-handler",
"unified-trade-in-metric-emitter","unified-trade-in-state-freshness-handler","unified-trade-in-cc-expander-controller").register("unified-trade-in-cc-card-controller",(c,a,d,f,n,h,y,p)=>{let g={};const t=new Set;let e={tradeInUX:{currentCXState:"",previousCXState:"",intentId:""},buyingOptionsContext:{selectedAapiBuyingOptionIndex:0,selectedModBuyingOptionIndex:0,isBuyingOptionTwisterPlusUnsupported:!1},ingressAsin:""};const q=(a,c="")=>({previousCXState:e.tradeInUX.currentCXState,currentCXState:a,
intentId:c}),u=(b)=>c.$(`#${b}${a.uiElements.DOM_RENDER_SUFFIX}`),C=(a,c)=>a.length===c.length&&a.every((a,b)=>a===c[b]),l=(a)=>{e=c.extend({},e,{buyingOptionsContext:c.extend({},e.buyingOptionsContext,a)})},b=(a,b=null)=>{b&&l(b);e=c.extend({},e,{tradeInUX:c.extend({},e.tradeInUX,q(a))})},D=()=>{var b=c.$(a.uiElements.selectors.cxStateInformation);if(!b.length)return a.ExtractionResult.STATELESS;g={};b=b.find(a.uiElements.selectors.tradeInOfferViewModelMatcher);return b.length&&b.toArray().every((b)=>
{{b=c.$(b);const f=parseInt(b.data(a.uiElements.selectors.dataAttributes.boKeyAttribute)),z=b.find(a.uiElements.selectors.longMessage);var e=b.find(a.uiElements.selectors.unifiedTradeInUXState).text().trim();const l=a.UnifiedTradeInUXState[e];e=z;var d=l;!isNaN(f)&&e.length&&d?b={boIndex:f,data:{longMessage:z,unifiedTradeInUXState:l,intentId:b.find(a.uiElements.selectors.intentId).text().trim()}}:(g={},v(a.UnifiedTradeInUXState.UNRECOVERABLE_ERROR),h.count("UnifiedTradeIn.Error.CardController.ExtractBuyingOptionData.InvalidBuyingOptionData"),
b=null)}if(!b)return!1;g[b.boIndex]=b.data;return!0})?a.ExtractionResult.EXTRACTION_SUCCEEDED:a.ExtractionResult.EXTRACTION_FAILED},E=()=>{Object.values(a.UnifiedTradeInUXState).forEach((b)=>{u(b).addClass(a.uiElements.styles.hiddenClass)})},m=()=>{var b=e.tradeInUX.previousCXState;b&&u(b).addClass(a.uiElements.styles.hiddenClass);a.DYNAMIC_MESSAGE_STATES.includes(e.tradeInUX.currentCXState)&&((b=g[e.buyingOptionsContext.selectedAapiBuyingOptionIndex])&&b.longMessage?(b=b.longMessage)?u(e.tradeInUX.currentCXState).find(a.uiElements.selectors.dynamicLongMessage).html(b.html()):
h.count("UnifiedTradeIn.Error.CardController.UpdateDynamicContent.NullLongMessage"):h.count(b?"UnifiedTradeIn.Error.CardController.RenderUxState.NullLongMessage":"UnifiedTradeIn.Error.CardController.RenderUxState.NullStateInformation"));(b=e.tradeInUX.currentCXState)?u(b).removeClass(a.uiElements.styles.hiddenClass):h.count("UnifiedTradeIn.Error.CardController.ShowUxState.NullUxState")},v=(a,c=null)=>{b(a,c);m()},r=()=>{e.tradeInUX.currentCXState===a.UnifiedTradeInUXState.INTENT_CREATED&&d.addAdditionalParamToATC(e.tradeInUX.intentId)},
F=(b)=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{c.trigger(a.events.actions.buyingOptionSwitched,b)})})},A=(b,f,d,u)=>{b={selectedModBuyingOptionIndex:b,selectedAapiBuyingOptionIndex:f,isBuyingOptionTwisterPlusUnsupported:d};f=g[f];if(d||!f||!f.unifiedTradeInUXState)return h.count("UnifiedTradeIn.Error.CardController.ValidateAndRender.InvalidBuyingOption"),v(a.UnifiedTradeInUXState.INVALID_BUYING_OPTION,b);if(!a.UX_ERROR_STATES.includes(f.unifiedTradeInUXState)&&u!==a.VALID_QUANTITY)return h.count("UnifiedTradeIn.Error.CardController.ValidateAndRender.InvalidQuantity"),
v(a.UnifiedTradeInUXState.INVALID_QUANTITY,b);l(b);(d=g[e.buyingOptionsContext.selectedAapiBuyingOptionIndex])&&d.unifiedTradeInUXState?e=c.extend({},e,{tradeInUX:c.extend({},e.tradeInUX,q(d.unifiedTradeInUXState,d.intentId||null))}):h.count(d?"UnifiedTradeIn.Error.CardController.SetTradeInUxStateFromContext.NullSelectedCxStateInformation":"UnifiedTradeIn.Error.CardController.SetTradeInUxStateFromContext.NullUnifiedTradeInUXState");m()},x=(b,c,e=!1)=>{if(g&&0<Object.keys(g).length){f.ccSelectionsClear(a.featureName);
var d=n.getSelectedQuantity(c);d=-1===d||"number"!==typeof d?a.VALID_QUANTITY:d;A(b,c,e,d);r();F(c)}};c.on(a.events.atc.postAtcBottomSheetId,()=>{const b=g[e.buyingOptionsContext.selectedAapiBuyingOptionIndex];b&&b.unifiedTradeInUXState===a.UnifiedTradeInUXState.INTENT_CREATED&&(B(),c.delay(()=>{y.refresh(e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.ingressAsin,{onStart:()=>{},onSuccess:()=>{w()},onFailure:()=>{h.count("UnifiedTradeIn.Error.CardController.Initialize.AtcExecutedStateRefreshFailed");
w()}})},a.twisterRefresh.refreshDelayAfterAtcMs))});c.on(a.events.quantity.quantityUpdatedEvent,function(b){g&&0<Object.keys(g).length&&(f.ccSelectionsClear(a.featureName),A(e.buyingOptionsContext.selectedModBuyingOptionIndex,e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.buyingOptionsContext.isBuyingOptionTwisterPlusUnsupported,b),r())});const B=()=>{c.capabilities.mobile?c.$(a.uiElements.selectors.expanderSectionClass).addClass(a.uiElements.styles.refreshOverlayClassMobile):c.$(a.uiElements.selectors.expanderSectionClass).addClass(a.uiElements.styles.refreshOverlayClassDesktop)},
w=()=>{c.capabilities.mobile?c.$(a.uiElements.selectors.expanderSectionClass).removeClass(a.uiElements.styles.refreshOverlayClassMobile):c.$(a.uiElements.selectors.expanderSectionClass).removeClass(a.uiElements.styles.refreshOverlayClassDesktop)};return{initialize:()=>{k.when(a.events.actions.atfRendered).execute(()=>{c.trigger(a.events.actions.cardControllerInitializeCalled);const b=D();if(b!==a.ExtractionResult.STATELESS){var d=parseInt(c.$(a.uiElements.selectors.selectedBuyingOptionIndex).text().trim()),
f=c.$(a.twisterRefresh.payloadElementSelector).data(a.twisterRefresh.asinDataAttribute)||null;b===a.ExtractionResult.EXTRACTION_FAILED||isNaN(d)||!f?(h.count("UnifiedTradeIn.Error.CardController.Initialize.ExtractBuyingOptionFailed"),E(),g={},v(a.UnifiedTradeInUXState.UNRECOVERABLE_ERROR)):(e=c.extend({},e,{ingressAsin:f}),x(d,d,!1),t.has(e.ingressAsin)?y.refresh(e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.ingressAsin,{onStart:()=>{B();p.collapse()},onSuccess:()=>{w();p.expand()},onFailure:()=>
{h.count("UnifiedTradeIn.Error.CardController.Initialize.AtfRenderedStateRefreshFailed");w();p.expand()}}):t.add(e.ingressAsin))}})},switchBuyingOption:x,updateBuyingOptionsState:(b)=>{if(g&&0<Object.keys(g).length){var c=Object.keys(g).sort(),d=Object.keys(b).sort();C(c,d)?(g=b,x(e.buyingOptionsContext.selectedModBuyingOptionIndex,e.buyingOptionsContext.selectedAapiBuyingOptionIndex,e.buyingOptionsContext.isBuyingOptionTwisterPlusUnsupported)):(g={},v(a.UnifiedTradeInUXState.UNRECOVERABLE_ERROR),
h.count("UnifiedTradeIn.Error.CardController.UpdateBuyingOptionsState.KeysMismatch"))}},showRemoteErrorState:()=>{g&&0<Object.keys(g).length&&v(a.UnifiedTradeInUXState.REMOTE_OPERATION_FAILED)},getSelectedAapiBuyingOptionIndex:()=>e.buyingOptionsContext.selectedAapiBuyingOptionIndex,getBuyingOptionIntentMap:()=>{const b={};Object.keys(g).forEach((a)=>{b[a]=g[a].intentId||""});return b},getIngressAsin:()=>e.ingressAsin}});"use strict";k.when("A","cc-manager","unified-trade-in-cc-constants","unified-trade-in-cc-expander-controller",
"unified-trade-in-cc-card-controller").register("unified-trade-in-cc-registration",(c,a,d,f,k)=>{const {featureName:h,featureAttribution:n}=d;a.registerFeature({featureName:h,featureAttribution:n,isMultiSelection:1},{init:function(a){k.initialize();f.expand()},validateInputParams:function(a){return!0},cardExpand:f.expand,cardCollapse:f.collapse,switchBuyingOption:function(a,c,d,e,f,h,n){k.switchBuyingOption(a,h,n)}})});"use strict";k.when("A").register("unified-trade-in-cc-constants",()=>({featureName:"unifiedTradeInIngress",
featureAttribution:"Website/CETech/UnifiedTradeIn",UnifiedTradeInUXState:Object.freeze({NO_INTENT:"NO_INTENT",INTENT_CREATED:"INTENT_CREATED",INTENT_BO_INVALID:"INTENT_BO_INVALID",REMOTE_OPERATION_FAILED:"REMOTE_OPERATION_FAILED",UNRECOVERABLE_ERROR:"UNRECOVERABLE_ERROR",INVALID_BUYING_OPTION:"INVALID_BUYING_OPTION",INVALID_QUANTITY:"INVALID_QUANTITY"}),UX_ERROR_STATES:["INTENT_BO_INVALID","REMOTE_OPERATION_FAILED","UNRECOVERABLE_ERROR","INVALID_BUYING_OPTION","INVALID_QUANTITY"],DYNAMIC_MESSAGE_STATES:["NO_INTENT",
"INTENT_CREATED","INTENT_BO_INVALID"],VALID_QUANTITY:1,ExtractionResult:Object.freeze({STATELESS:"STATELESS",EXTRACTION_SUCCEEDED:"EXTRACTION_SUCCEEDED",EXTRACTION_FAILED:"EXTRACTION_FAILED"}),remoteOperations:{lifecycle:Object.freeze({NOT_STARTED:"NOT_STARTED",IN_PROGRESS:"IN_PROGRESS",ERROR:"ERROR"}),responseCodes:Object.freeze({SUCCESS:"SUCCESS",SUCCESS_STATE_UPDATED:"SUCCESS_STATE_UPDATED"}),timeoutMs:2500,responseSuffix:":response"},twisterRefresh:{eventName:"a:tradeIn:tanooki:v3:fetchIngressMessaging",
payloadElementSelector:"#utxTwisterRefreshPayload",asinDataAttribute:"asin",refreshDelayAfterAtcMs:500},uiElements:{DOM_RENDER_SUFFIX:"_DOM_RENDER",popoverIds:{utxPopoverContent:"utx_popover_content"},styles:{hiddenClass:"aok-hidden",invisibleClass:"utx-invisible",refreshOverlayClassDesktop:"js-feature-refresh-overlay",refreshOverlayClassMobile:"tp-js-feature-refresh-overlay"},buttonFactory:{classPrefix:"unified-tradein-btn-",actionButtonClass:"utx-action-button",actionButtonSelector:".utx-action-button",
displayTextSelector:".utx-display-text",loadingSpinnerSelector:".utx-loading-spinner",spinnerDelayMs:1E3,uniqueIds:{spawnGrading:"spawn-grading",removeConfirmation:"remove-confirmation",retry:"retry"}},selectors:{expanderContent:".unifiedTradeInIngressExpanderContent",expanderContentExpand:"unifiedTradeInIngressExpanderContent-expand",expanderIconDesktop:".unifiedTradeInIngressExpanderIconDesktop",expanderIconMobile:".unifiedTradeInIngressExpanderIconMobile",expanderSectionClass:".unifiedTradeInIngressExpanderSection",
selectedBuyingOptionIndex:"#utxSelectedBuyingOptionIndex",dynamicLongMessage:".utxDynamicLongMessage",cxStateInformation:"#cxStateInformation",unifiedTradeInUXState:".unifiedTradeInUXState",tradeInOfferViewModelMatcher:'[id^\x3d"tradeInOfferViewModel_"]',longMessage:".utxLongMessage",intentId:".intentId",payload:".payload",visibleFilter:":visible",dataAttributes:{tradeInIntentId:"tradeInIntentId",boKeyAttribute:"bo-key"},quantity:{selectByName:'select[name\x3d"quantity"]'},buyBoxAccordion:"#buyBoxAccordion"}},
events:{actions:{toggleExpander:"toggleUnifiedTradeInIngressExpander",tradeInSubmitted:"a:tradeIn:tanooki:v3:intentAction:create:response",atfRendered:"atf",buyingOptionSwitched:"unifiedTradeIn:buyingOption:switched",closeSideSheet:"a:tradeIn:tanooki:v3:closeSidesheet",cardControllerInitializeCalled:"unifiedTradeIn:cardController:initializeCalled"},declarativeActions:{removeButton:"unifiedtradeiningress_remove_button",spawnGradingQuestionnaire:"unifiedtradeiningress_spawnselfgradingquestionaire_button",
retryButton:"unifiedtradeiningress_retry_button"},domEvents:{click:"click"},quantity:{dropdownSelectedEvent:"a:dropdown:selected:quantity",quantityUpdatedEvent:"unifiedTradeIn:quantity:updated"},atc:{postAtcBottomSheetId:"a:sheet:beforeShow:attach_accessory_sheet"}},actions:{toggleExpander:"toggleUnifiedTradeInIngressExpander",tradeInSubmitted:"unifiedTradeIn:detailPage:tradeInSubmitted",atfRendered:"atf"},selectors:{expanderContent:".unifiedTradeInIngressExpanderContent",expanderContentExpand:"unifiedTradeInIngressExpanderContent-expand",
expanderIconDesktop:".unifiedTradeInIngressExpanderIconDesktop",expanderIconMobile:".unifiedTradeInIngressExpanderIconMobile",dataAttributes:{tradeInIntentId:"tradeInIntentId"}}}));"use strict";k.when("A","unified-trade-in-cc-constants","unified-trade-in-remote-operations-tanookiv3-bridge","unified-trade-in-popover-controller","unified-trade-in-cc-card-controller","unified-trade-in-button-factory","unified-trade-in-scroll-controller","unified-trade-in-metric-emitter").register("unified-trade-in-action-listeners",
(c,a,d,f,k,h,m,p)=>{function g(c,e){const f=c.data&&c.data.auiEventName;if(f){var b=JSON.parse(c.$currentTarget.find(a.uiElements.selectors.payload).text().trim()||"{}"),g=k.getBuyingOptionIntentMap();Object.keys(b).length===Object.keys(g).length?Object.keys(b).forEach((a)=>{b[a].intentId=g[a]}):p.count("UnifiedTradeIn.Error.DeclarativeActionHandler.PublishEventWithPayload.KeysLengthMismatch");c={eventName:f,payload:{buyingOptionIndex:String(k.getSelectedAapiBuyingOptionIndex()),buyingOptionContextMap:b,
ingressAsin:k.getIngressAsin()}};d.publishWithLifeCycle(c,e)}else p.count("UnifiedTradeIn.Error.DeclarativeActionHandler.PublishEventWithPayload.NullEventToFire")}let n,e,q;c.declarative(a.events.declarativeActions.spawnGradingQuestionnaire,a.events.domEvents.click,function(c){if(!e){const d=c.$currentTarget.find(a.uiElements.buttonFactory.actionButtonSelector).first();e=h.getInstance(d,a.uiElements.buttonFactory.uniqueIds.spawnGrading)}e&&!e.isBlocked()&&g(c,{onStart:()=>e.block(),onSuccess:()=>
{e.reset();m.blockScrolling()},onFailure:()=>e.reset()})});c.declarative(a.events.declarativeActions.removeButton,a.events.domEvents.click,function(c){const e=c.$currentTarget.find(a.uiElements.buttonFactory.actionButtonSelector).first();(n=h.getInstance(e,a.uiElements.buttonFactory.uniqueIds.removeConfirmation))&&!n.isBlocked()&&g(c,{onStart:()=>n.block(),onSuccess:()=>{n.destroy();f.hidePopover(a.uiElements.popoverIds.utxPopoverContent)},onFailure:()=>{n.destroy();f.hidePopover(a.uiElements.popoverIds.utxPopoverContent)}})});
c.declarative(a.events.declarativeActions.retryButton,a.events.domEvents.click,function(c){q||(c=c.$currentTarget.find(a.uiElements.buttonFactory.actionButtonSelector).first(),q=h.getInstance(c,a.uiElements.buttonFactory.uniqueIds.retry));q&&!q.isBlocked()&&d.retryLastFailedOperation({onStart:()=>q.block(),onSuccess:()=>q.reset(),onFailure:()=>q.reset()})})});"use strict";k.when("A","cc-manager","unified-trade-in-cc-constants","unified-trade-in-metric-emitter").register("unified-trade-in-cc-expander-controller",
(c,a,d,f)=>{function k(c){const e=h(g.expanderContent).hasClass(g.expanderContentExpand);c=c!==r?c:!e;h(t?g.expanderIconMobile:g.expanderIconDesktop).toggleClass("rotate",c);c&&0<h(g.expanderContent).length?(h(g.expanderContent).addClass(g.expanderContentExpand),a.cardExpanded(m),f.count("UnifiedTradeIn.ExpanderController.CardExpanded")):(h(g.expanderContent).removeClass(g.expanderContentExpand),f.count("UnifiedTradeIn.ExpanderController.CardCollapsed"))}const h=c.$,{featureName:m,actions:p,selectors:g}=
d,t=c.capabilities&&c.capabilities.mobile;c.declarative(p.toggleExpander,["click","keydown"],function(a){"keydown"===a.type&&13!==a.$event.keyCode&&32!==a.$event.keyCode||k()});return{toggleTradeInIngressCard:k,expand:()=>k(!0),collapse:()=>k(!1)}});k.register("unified-trade-in-metric-emitter",()=>({count:function(c){m.ue&&m.ue.count&&m.ue.count(c,(m.ue.count(c)||0)+1)}}));"use strict";k.when("A","a-modal","unified-trade-in-metric-emitter").register("unified-trade-in-popover-controller",(c,a,d)=>
({hidePopover:function(c){c?(c=a.get(c))?(c.hide(),c.isActive()&&(d.count("UnifiedTradeIn.Error.PopOverController.HidePopover.HidePopoverFailed"),c.hide())):d.count("UnifiedTradeIn.Error.PopOverController.HidePopover.NullPopoverInstance"):d.count("UnifiedTradeIn.Error.PopOverController.HidePopover.NullPopoverName")}}));"use strict";k.when("A","unified-trade-in-cc-constants","a-dropdown").register("unified-trade-in-quantity-handler",(c,a,d)=>{c.on(a.events.quantity.dropdownSelectedEvent,function(d){c.trigger(a.events.quantity.quantityUpdatedEvent,
Number(d.value))});return{getSelectedQuantity:function(f){f=c.$(a.uiElements.selectors.buyBoxAccordion).children().eq(f).find(a.uiElements.selectors.quantity.selectByName);return(f=f.length&&d.getSelect(f))?Number(f.val()):-1}}});"use strict";k.when("A","unified-trade-in-cc-constants","unified-trade-in-cc-card-controller","unified-trade-in-metric-emitter").register("unified-trade-in-remote-operations-tanookiv3-bridge",(c,a,d,f)=>{function k(){if(crypto&&crypto.randomUUID)return crypto.randomUUID();
if(crypto&&crypto.getRandomValues){const b=new Uint8Array(16);crypto.getRandomValues(b);return Array.from(b,(b)=>b.toString(16).padStart(2,"0")).join("")}return Date.now().toString(36)+Math.random().toString(36).substring(2)}function h(b,d={}){if(!b||!b.eventName)return{};const e=k();return{requestId:e,triggerEventName:b.eventName,eventPayload:c.extend({},b.payload||{},{requestId:e}),responseEventName:b.eventName+a.remoteOperations.responseSuffix,timeoutId:null,callbacks:d}}function m(){const b=l.current;
c.on(b.responseEventName,q);c.trigger(b.triggerEventName,b.eventPayload);b.timeoutId=c.delay(()=>{l.current===b&&(f.count("UnifiedTradeIn.Error.RemoteOperationsBridge.HandleTimeout"),p())},a.remoteOperations.timeoutMs)}function p(){const b=l.current&&l.current.callbacks;if(b&&b.onFailure)b.onFailure();u();l.lastFailed=l.current;l.current=null;d.showRemoteErrorState()}function g(b){for(const c of Object.keys(b)){const d=b[c],e=a.UnifiedTradeInUXState[d.uxState];if(!e)return!1;if(a.DYNAMIC_MESSAGE_STATES.includes(e)&&
!d.longMessage)return f.count("UnifiedTradeIn.Error.RemoteOperationsBridge.ValidateUxStates.NullLongMessage"),!1}return!0}function t(b){const d={},e=b.tradeInIngressMessaging;if(!e)return d;if(!g(e))return{};Object.keys(e).forEach((b)=>{const f=e[b],g=a.UnifiedTradeInUXState[f.uxState];d[b]={longMessage:c.$("\x3cdiv\x3e").text(f.longMessage||""),unifiedTradeInUXState:g,intentId:f.intentId||""}});return d}function e(){const b=l.current&&l.current.callbacks;if(b&&b.onSuccess)b.onSuccess();r()}function q(b){l.current&&
l.current.requestId===b.requestId&&(b.status===a.remoteOperations.responseCodes.SUCCESS?e():b.status===a.remoteOperations.responseCodes.SUCCESS_STATE_UPDATED?(b=t(b),d.updateBuyingOptionsState(b),e()):(f.count("UnifiedTradeIn.Error.RemoteOperationsBridge.HandleErrorResponse"),p()))}function u(){const b=l.current;b&&(b.responseEventName&&c.off(b.responseEventName),b.timeoutId&&clearTimeout(b.timeoutId))}function r(){u();l.current=null;l.lastFailed=null}const l={current:null,lastFailed:null};c.on(a.events.actions.tradeInSubmitted,
function(b){b.status===a.remoteOperations.responseCodes.SUCCESS_STATE_UPDATED?(b=t(b),d.updateBuyingOptionsState(b)):f.count(b.status?"UnifiedTradeIn.Error.RemoteOperationsBridge.TradeInSubmittedHandler.UnhandledStatusCode."+b.status:"UnifiedTradeIn.Error.RemoteOperationsBridge.TradeInSubmittedHandler.NullStatusCode")});c.on(a.events.actions.buyingOptionSwitched,function(){l.lastFailed=null});c.on(a.events.actions.cardControllerInitializeCalled,function(){r()});return{publishWithLifeCycle:function(b,
a={}){a=a||{};b=h(b,a);if(0===Object.keys(b).length)return!1;if(l.current){const a=l.current.callbacks;if(a&&a.onFailure)a.onFailure();r()}if(a.onStart)a.onStart();l.lastFailed=null;l.current=b;m();return!0},retryLastFailedOperation:function(a){if(!l.lastFailed||l.current){if(a&&a.onBlocked)a.onBlocked();return!1}if((a=a||l.lastFailed.callbacks)&&a.onStart)a.onStart();l.current=c.extend({},l.lastFailed);l.current.callbacks=a;l.lastFailed=null;m();return!0}}});"use strict";k.when("A","unified-trade-in-cc-constants").register("unified-trade-in-scroll-controller",
(c,a)=>{c.on(a.events.actions.closeSideSheet,function(){c.$("body").css("overflow","auto")});return{blockScrolling:function(){c.$("body").css("overflow","hidden")}}});"use strict";k.when("A","unified-trade-in-cc-constants").register("unified-trade-in-state-freshness-handler",(c,a)=>({refresh:(d,f,m)=>{const h=c.$(a.twisterRefresh.payloadElementSelector),n={buyingOptionContextMap:JSON.parse(h.text().trim()||"{}"),ingressAsin:f,buyingOptionIndex:d};k.when("unified-trade-in-remote-operations-tanookiv3-bridge").execute(function(c){c.publishWithLifeCycle({eventName:a.twisterRefresh.eventName,
payload:n},m)})}}))});